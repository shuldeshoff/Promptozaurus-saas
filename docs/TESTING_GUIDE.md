# Инструкция по тестированию Promptozaurus

## Цель тестирования
Проверить соответствие функциональности приложения референсному проекту.

---

## 1. Работа с блоками контекста

### 1.1 Создание блоков контекста
- [ ] Создать несколько тестовых блоков контекста
- [ ] Убедиться, что блоки отображаются в левой панели
- [ ] Проверить возможность выбора и активации блока

### 1.2 Работа с элементами и субблоками
- [ ] **Создание элементов блока**: Нажать кнопку "+" на уровне блока контекста
- [ ] **Создание субблоков**: Нажать кнопку "+" внутри элемента для создания субблоков
- [ ] **Раскрытие/сворачивание**: Проверить кнопки раскрытия и сворачивания субблоков
- [ ] Убедиться, что иерархия элементов отображается корректно

---

## 2. Разделение текста (Split функция)

### 2.1 Разделение текста на субблоки
**Тестовый сценарий:**
1. Создать элемент с большим текстом
2. Нажать кнопку "Ножницы" (Split)
3. Выбрать **"Разделить на субблоки"**
4. Указать количество частей (например, 5)
5. Выбрать метод деления: **"По концу предложения"**
6. Нажать **"Предпросмотр"** для проверки результата
7. Проверить, что текст разделен корректно
8. Опционально: Отметить **"Сохранить исходный текст"** или **"Удалить исходный"**
9. Нажать **"Применить"**

**Ожидаемый результат:**
- [ ] Создано 5 субблоков под исходным элементом
- [ ] Текст разделен примерно по указанным границам
- [ ] Исходный текст сохранен или удален согласно настройкам

### 2.2 Разделение текста на основные элементы
**Тестовый сценарий:**
1. Взять тот же элемент с текстом
2. Нажать кнопку "Ножницы" (Split)
3. Выбрать **"Разделить на основные элементы"**
4. Указать количество частей (например, 3)
5. Отметить **"Удалить исходный текст"**
6. Нажать **"Предпросмотр"** (1, 2, 3 части)
7. Нажать **"Применить"**

**Ожидаемый результат:**
- [ ] Исходный элемент разделен на 3 отдельных элемента того же уровня
- [ ] Первая часть осталась в исходном элементе
- [ ] Созданы 2 новых элемента со второй и третьей частями
- [ ] Исходный большой текст удален

---

## 3. Настройка AI провайдеров

### 3.1 Добавление API ключа
**Тестовый сценарий (на примере OpenRouter):**
1. Открыть **"Настройки AI"**
2. Выбрать провайдера (например, **OpenRouter**)
3. Вставить API ключ
4. Нажать **"Проверить ключ"**

**Ожидаемый результат:**
- [ ] Ключ успешно проверен
- [ ] Статус изменился на **"Active"** (зеленый)

### 3.2 Настройка моделей
**Тестовый сценарий:**
1. После добавления ключа, открыть **"Настройки моделей"**
2. Нажать **"Обновить список доступных моделей"** (если провайдер поддерживает API списка моделей)
3. Выбрать модель из списка (например, **"gpt-4o-mini"** или **"meta-llama"**)
4. Настроить параметры:
   - Temperature (например, 0.7)
   - Max tokens (например, 2000)
5. Нажать **"Добавить конфигурацию"**
6. Опционально: Добавить вторую модель (например, **"gpt-3.5-turbo"**)
7. Установить одну из моделей **"По умолчанию"**

**Ожидаемый результат:**
- [ ] Список моделей загружен (для провайдеров с API)
- [ ] Модели добавлены в конфигурацию
- [ ] Одна модель установлена по умолчанию
- [ ] Конфигурации сохранены

**Примечание для провайдеров без API списка моделей:**
- [ ] Для **Anthropic** и подобных: модели захардкожены в коде
- [ ] Список доступных моделей отображается из предустановленного списка

### 3.3 Глобальные настройки AI
Проверить третий пункт меню:
- [ ] **Timeout** (тайм-аут запроса)
- [ ] **Max retries** (количество попыток повтора)
- [ ] Другие глобальные параметры

---

## 4. Работа с промптами и отправка запросов

### 4.1 Создание промпта
**Тестовый сценарий:**
1. Перейти на вкладку **"Промпты"**
2. Создать новый блок промпта
3. В правой панели выбрать элементы из **"Карты контекста"**
4. Например, выбрать **"Рассказ/История текста"**
5. Проверить, что выбранный контекст отображается в промпте

**Ожидаемый результат:**
- [ ] Карта контекста отображается полностью
- [ ] Можно выбрать элементы контекста
- [ ] Выбранный контекст добавляется в промпт

### 4.2 Настройка промпта
**Проверить:**
- [ ] Текст промпта можно редактировать
- [ ] Можно включить/отключить **"Оборачивание тегами"** (например, `<text>...</text>`)
- [ ] Пример: "Кратко перескажи роман" + контекст в тегах `<text>Рассказ здесь</text>`

### 4.3 Предпросмотр и копирование
- [ ] Нажать **"Предпросмотр"** для просмотра полного промпта
- [ ] Проверить, что промпт отображается в полноэкранном режиме
- [ ] Нажать **"Копировать"** для копирования в буфер обмена
- [ ] Убедиться, что текст скопирован корректно

### 4.4 Отправка через API
**Тестовый сценарий:**
1. Выбрать модель из списка (например, **"gpt-4o-mini"** или легкую модель **"nano"**)
2. Нажать **"Сгенерировать ответ"**
3. Дождаться ответа от модели

**Ожидаемый результат:**
- [ ] Запрос отправлен успешно
- [ ] Ответ получен и отображается
- [ ] Быстрые модели (nano) отвечают быстро
- [ ] Качественные модели дают более детальные ответы

### 4.5 Сохранение ответа
**Тестовый сценарий 1 - Сохранение в новый блок:**
1. Получить ответ от AI
2. Нажать **"Сохранить в новом блоке"**
3. Система автоматически создает блок с названием

**Ожидаемый результат:**
- [ ] Создан новый блок контекста
- [ ] Ответ сохранен как элемент нового блока
- [ ] Блок отображается в левой панели

**Тестовый сценарий 2 - Сохранение в существующий блок:**
1. Получить второй ответ от AI (например, от другой модели, например **"Gemini"**)
2. Нажать **"Сохранить в существующий блок"**
3. Выбрать блок из списка (например, **"Тексты для анализа"**)
4. Нажать **"Сохранить"**

**Ожидаемый результат:**
- [ ] Ответ добавлен как новый элемент в выбранный блок
- [ ] Элемент отображается в блоке
- [ ] Можно открыть и просмотреть сохраненный ответ

**Альтернатива:**
- [ ] Опция **"Просто копировать"** - копирует ответ в буфер обмена без сохранения

---

## 5. Дополнительные функции для проверки

### 5.1 Экспорт блоков
- [ ] Экспорт блока контекста в файл
- [ ] Проверка формата экспорта

### 5.2 Удаление элементов
- [ ] Удаление элемента контекста с подтверждением
- [ ] Удаление субблока с подтверждением
- [ ] Удаление целого блока контекста

### 5.3 Перемещение элементов
- [ ] Перемещение элементов вверх/вниз
- [ ] Перемещение субблоков внутри родительского элемента

### 5.4 Полноэкранный редактор
- [ ] Открытие элемента в полноэкранном редакторе (кнопка "Редактировать")
- [ ] Редактирование текста
- [ ] Сохранение изменений

---

## 6. Проверка UI и UX

### 6.1 Панели и навигация
- [ ] Левая панель проектов сворачивается/разворачивается
- [ ] Панель контекста отображает все блоки
- [ ] Панель промптов отображает все промпты
- [ ] Редактор отображает выбранный элемент

### 6.2 Empty State (пустое состояние)
- [ ] При отсутствии выбранного проекта отображается "Проект не выбран"
- [ ] Кнопка "Открыть панель проектов" работает корректно
- [ ] Кнопки создания блоков неактивны (серые) до выбора проекта

### 6.3 Локализация
- [ ] Все тексты отображаются на выбранном языке (RU/EN)
- [ ] Нет пропущенных ключей локализации
- [ ] Модальные окна имеют корректные заголовки

---

## Чек-лист основных функций

| Функция | Статус | Примечания |
|---------|--------|------------|
| Создание блоков контекста | ⬜ |  |
| Создание элементов и субблоков | ⬜ |  |
| Split на субблоки | ⬜ |  |
| Split на основные элементы | ⬜ |  |
| Добавление API ключей | ⬜ |  |
| Проверка API ключей | ⬜ |  |
| Загрузка списка моделей | ⬜ |  |
| Настройка конфигураций моделей | ⬜ |  |
| Создание промптов | ⬜ |  |
| Выбор контекста для промпта | ⬜ |  |
| Предпросмотр промпта | ⬜ |  |
| Отправка запроса через API | ⬜ |  |
| Сохранение ответа в новый блок | ⬜ |  |
| Сохранение ответа в существующий блок | ⬜ |  |
| Экспорт блоков | ⬜ |  |
| Удаление элементов | ⬜ |  |
| Полноэкранный редактор | ⬜ |  |

---

## Известные ограничения

### Google Gemini API
- **Проблема**: API ключ может не работать из-за региональных ограничений
- **Ошибка**: `"User location is not supported for the API use"`
- **Решение**: 
  1. Проверить настройки API ключа в Google Cloud Console
  2. Создать новый ключ без географических ограничений
  3. Убедиться, что IP сервера не заблокирован

### Провайдеры с хардкоженными моделями
- **Anthropic**: Список моделей захардкожен в коде (нет API для получения списка)
- **X.AI Grok**: Список моделей захардкожен

---

## Примечания для тестирования

1. **OpenRouter** - универсальный агрегатор, удобен для тестирования разных моделей
2. **Быстрые модели** (nano, flash) - используйте для быстрой проверки функциональности
3. **Качественные модели** (GPT-4, Claude) - для проверки качества ответов
4. **Split функция** - ключевая особенность проекта, тестировать тщательно
5. **Сохранение ответов** - проверить оба варианта (новый блок и существующий)

---

## Итоговый чек-лист
- [ ] Все основные функции работают
- [ ] UI/UX соответствует ожиданиям
- [ ] Нет критических ошибок
- [ ] Локализация полная
- [ ] API интеграции работают
- [ ] Данные сохраняются корректно

